!function(){"use strict";angular.module("ngErrorStack",[])}(),function(){"use strict";function r(r){var e,t=[];if(r=r||{},this.name="AppError",this.title=r.title||"Error",this.type=r.type||"App",this.message=r.message||"An error occurred.",this.detail=r.detail||"",this.extendedInfo=r.extendedInfo||"",this.code=r.code||"",this.isAppError=!0,e=(new Error).stack){e=e.split("\n");for(var a=0;a<e.length;a++)-1===e[a].indexOf("AppError")&&t.push(e[a]);this.stack=t.join("\n")}}function e(e){function t(a,n){var o,s,i=Function.caller||t;return n=angular.merge({},{logLevel:"error",logArgs:[]},n),o=new r(a),s=[o].concat(n.logArgs),e[n.logLevel].apply(i,s),n.reporter&&n.reporter.apply(i,s),o}return t}e.$inject=["$log"],angular.module("ngErrorStack").factory("appError",e)}(),function(){"use strict";angular.module("ngErrorStack").constant("ERROR_EVENT","error-stack:error")}(),function(){"use strict";function r(r){r.interceptors.push("errorHttpInterceptor")}r.$inject=["$httpProvider"],angular.module("ngErrorStack").config(r)}(),function(){"use strict";function r(r,e){return{responseError:function(t){return e(t),r.reject(t)}}}r.$inject=["$q","errorParser"],angular.module("ngErrorStack").service("errorHttpInterceptor",r)}(),function(){"use strict";function r(r){return function(e,t){var a,n;return 401===e.status?"PROMO_CODE_MAX_USES_EXCEEDED"===e.data.code?(r.debug("authErrorParser - promo code max uses exceeded"),{type:"App.PromoCode.MaxUsesExceeded",message:e.data.message,detail:e}):e.config.url.match(/auth\/login/)?(r.debug("authErrorParser - error during login due to invalid credentials"),{type:"App.Http.Auth.InvalidLoginError",title:"Invalid Login Details",message:"Invalid username or password provided.",detail:e}):e.config.url.match(/auth\/logout/)?(r.debug("authErrorParser - error during logout; supressing error"),!1):(n=e&&e.data?e.data.message:"Sorry, you need to login first.",r.debug("authErrorParser - error due to invalid or expired token"),{type:"App.Http.Auth.RequiredError",title:"Login Required",message:n,detail:e}):403===e.status?(a=angular.isString(e.data)?e.data:"Sorry, you do not have permission to perform that action.",{type:"App.Http.Auth.DeniedError",title:"Permission Denied",message:a,detail:e}):void t(e)}}r.$inject=["$log"],angular.module("ngErrorStack").factory("errorParserAuth",r)}(),function(){"use strict";function r(){return function(r,e){if(-1===r.status)return{title:"Cannot Reach Server",type:"App.Http.ConnectionRefusedError",message:"Sorry, we weren't able to reach the ReviewMyBill.com server. Please check your internet connection.",detail:r};e(r)}}r.$inject=[],angular.module("ngErrorStack").factory("errorParserConnectionRefused",r)}(),function(){"use strict";function r(){return function(r,e){if(angular.isString(r.data))return{type:"App.RestApi.DefaultError",message:r.data,extendedInfo:r};if(angular.isObject(r.data)&&angular.isObject(r.data)&&angular.isString(r.data.message))return{type:"App.RestApi.DefaultError",message:r.data.message,detail:r.data.code,extendedInfo:r};e(r)}}r.$inject=[],angular.module("ngErrorStack").factory("errorParserExpressDefault",r)}(),function(){"use strict";function r(){return function(r,e){var t;if(404===r.status)return t=r.data&&r.data.entityName&&-1!==r.data.entityName.indexOf("PromoCode.code")?"Sorry, that promo code is not valid or does not exist.":"Sorry, we weren't able to find that: "+r.data.message,{type:"App.Http.NotFoundError",message:t,detail:r};e(r)}}r.$inject=[],angular.module("ngErrorStack").factory("errorParserNotFound",r)}(),function(){"use strict";function r(){return function(r,e){var t,a,n;if(400===r.status&&angular.isObject(r.data)&&angular.isArray(r.data.errors)){for(t={type:"App.RestApi.ValidationError",title:"Validation Error",message:r.data.message||"We were unable to validate your submission",detail:r,errors:[]},n=0;n<r.data.errors.length;n++)(a={message:"",field:r.data.errors[n].field}).message+=r.data.errors[n].messages.join(","),t.errors.push(a);return t}e(r)}}r.$inject=[],angular.module("ngErrorStack").factory("errorParserValidation",r)}(),function(){"use strict";function r(){var r=this;this.parsers=[],this.parser=function(r){if(!angular.isFunction(r))throw new TypeError("Parser must be a function");this.parsers.push(r)},this.$get=["appError","errorStorage",function(e,t){var a;return r.parsers.push(function(r){angular.isString(r)&&(r={message:r}),angular.isObject(r)||(r={extendedInfo:r}),r.type||(r.type="App.Error"),r.message||(r.message="An unexpected error occurred"),angular.isArray(r.errors)||(r.errors=[]),t(r)}),a=function(a){function n(o,s){var i,u=r.parsers[s];!1!==(i=u(a,function(r){if(!1!==i){if(i)throw e({type:"App.LogicError",message:"next() called for error parser chain but parsed result already returned",detail:a,extendedInfo:r});n(r,s+1)}}))&&angular.isObject(i)&&(i.parsed=!0,t(i))}n(a,0)},a.parser=function(e){var t=r.parsers.length-1;t<0&&(t=0),r.parsers.splice(t,0,e)},a}]}r.$inject=[],angular.module("ngErrorStack").provider("errorParser",r)}(),function(){"use strict";function r(r,e){return function(t){return t?(r.error=t,r.$broadcast(e,t)):!1!==t&&null!==t||delete r.error,r.error}}r.$inject=["$rootScope","ERROR_EVENT"],angular.module("ngErrorStack").factory("errorStorage",r)}();